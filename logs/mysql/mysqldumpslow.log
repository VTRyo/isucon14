Count: 3  Time=543.17s (1629s)  Lock=0.03s (0s)  Rows=0.3 (1), []@[]
  throttle:      N 'S' warning(s) suppressed.

Count: 1  Time=0.17s (0s)  Lock=0.00s (0s)  Rows=100.0 (100), isucon[isucon]@localhost
  SELECT id,
  owner_id,
  name,
  access_token,
  model,
  is_active,
  created_at,
  updated_at,
  IFNULL(total_distance, N) AS total_distance,
  total_distance_updated_at
  FROM chairs
  LEFT JOIN (SELECT chair_id,
  SUM(IFNULL(distance, N)) AS total_distance,
  MAX(created_at)          AS total_distance_updated_at
  FROM (SELECT chair_id,
  created_at,
  ABS(latitude - LAG(latitude) OVER (PARTITION BY chair_id ORDER BY created_at)) +
  ABS(longitude - LAG(longitude) OVER (PARTITION BY chair_id ORDER BY created_at)) AS distance
  FROM chair_locations) tmp
  GROUP BY chair_id) distance_table ON distance_table.chair_id = chairs.id
  WHERE owner_id = 'S'

Count: 7  Time=0.06s (0s)  Lock=0.00s (0s)  Rows=0.0 (0), []@[]
  throttle:        N 'S' warning(s) suppressed.

Count: 9  Time=0.05s (0s)  Lock=0.00s (0s)  Rows=1.0 (9), isucon[isucon]@localhost
  SELECT status FROM ride_statuses WHERE ride_id = 'S' ORDER BY created_at DESC LIMIT N

Count: 1  Time=0.05s (0s)  Lock=0.00s (0s)  Rows=0.0 (0), isucon[isucon]@localhost
  SELECT * FROM ride_statuses WHERE ride_id = 'S' AND app_sent_at IS NULL ORDER BY created_at ASC LIMIT N

Count: 9  Time=0.05s (0s)  Lock=0.00s (0s)  Rows=0.0 (0), []@[]
  throttle:         N 'S' warning(s) suppressed.

Count: 1  Time=0.01s (0s)  Lock=0.00s (0s)  Rows=1.0 (1), isucon[isucon]@localhost
  SELECT * FROM rides WHERE chair_id = 'S' ORDER BY created_at DESC LIMIT N

Count: 4  Time=0.01s (0s)  Lock=0.00s (0s)  Rows=1.0 (4), isucon[isucon]@localhost
  SELECT COUNT(*) = N FROM (SELECT COUNT(chair_sent_at) = N AS completed FROM ride_statuses WHERE ride_id IN (SELECT id FROM rides WHERE chair_id = 'S') GROUP BY ride_id) is_completed WHERE completed = FALSE

Count: 3  Time=0.00s (0s)  Lock=0.00s (0s)  Rows=0.7 (2), isucon[isucon]@localhost
  SELECT * FROM rides WHERE chair_id = 'S' ORDER BY updated_at DESC LIMIT N

Count: 5  Time=0.00s (0s)  Lock=0.00s (0s)  Rows=2.8 (14), isucon[isucon]@localhost
  SELECT rides.* FROM rides JOIN ride_statuses ON rides.id = ride_statuses.ride_id WHERE chair_id = 'S' AND status = 'S' AND updated_at BETWEEN 'S' AND 'S' + INTERVAL N MICROSECOND

Count: 6  Time=0.00s (0s)  Lock=0.00s (0s)  Rows=1.0 (6), isucon[isucon]@localhost
  SELECT * FROM chairs WHERE access_token = 'S'

Count: 1  Time=0.00s (0s)  Lock=0.00s (0s)  Rows=100.0 (100), isucon[isucon]@localhost
  SELECT * FROM chairs WHERE owner_id = 'S'

Count: 5  Time=0.00s (0s)  Lock=0.00s (0s)  Rows=1.0 (5), isucon[isucon]@localhost
  SELECT * FROM chairs INNER JOIN (SELECT id FROM chairs WHERE is_active = TRUE ORDER BY RAND() LIMIT N) AS tmp ON chairs.id = tmp.id LIMIT N

Count: 164  Time=0.00s (0s)  Lock=0.00s (0s)  Rows=0.0 (1), isucon[isucon]@localhost
  SELECT * FROM rides WHERE chair_id IS NULL ORDER BY created_at LIMIT N

